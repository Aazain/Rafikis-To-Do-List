(this["webpackJsonprafikis-to-do-list"]=this["webpackJsonprafikis-to-do-list"]||[]).push([[0],{36:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(12),o=a.n(n),r=a(13),c=a(6),i=a(5),l=a.n(i);function d(){return"localhost"===location.hostname?"http://localhost:4000":"https://rafikis-to-do-list.onrender.com"}const u={accessToken:localStorage.getItem("accessToken"),refreshToken:localStorage.getItem("refreshToken")},m=new Headers({"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(u.accessToken)});function h(){return"undefined"!==u.accessToken&&"undefined"!==u.refreshToken&&u.accessToken&&u.refreshToken?fetch("".concat(d(),"/todo"),{method:"GET",headers:m}).then((e=>e.json())).then((e=>e)).catch((()=>(l()("Error","Session Expired, Please Log In","error").then((function(){window.location.href="/"})),[{error:"session expired"}]))):(l()("Error","Session Expired, Please Log In","error").then((function(){window.location.href="/"})),[{error:"session expired"}])}async function j(e,t,a){return t&&""!==t?fetch("".concat(d(),"/todo/").concat(e),{method:"PATCH",headers:m,body:JSON.stringify({task:t,status:a})}).then((e=>e)):(l()("Error","Do Not Leave Text Field Empty","error"),"field empty")}async function p(e,t){await fetch("".concat(d(),"/users/login"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e,password:t})}).then((e=>e.json())).then((t=>{console.log(t),"user does not exist"===t.message?l()("Error","A User With This Email Does Not Exist","error"):"incorrect email or password"===t.message?l()("Error","Incorrect Email or Password","error"):(localStorage.setItem("email",e),localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("refreshToken",t.refreshToken),window.location.href="/list")}))}function f(){localStorage.setItem("accessToken","undefined"),localStorage.setItem("refreshToken","undefined"),localStorage.setItem("email","undefined"),window.location.href="/"}var g=a(39),k=a(1);var b=function(e){let[t,a]=Object(s.useState)(""),[n,o]=Object(s.useState)(""),r=new Date(e.createdAt).toLocaleString("en-US",{month:"long",weekday:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",year:"numeric",hour12:!0}),c=new Date(e.updatedAt).toLocaleString("en-US",{month:"long",weekday:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",year:"numeric",hour12:!0});function i(t){"confirmEdit"===t.target.className?n===e.task?l()("Error","You Did Not Make Any Changes To The Item","info"):(!async function(){if(e.itemId&&""!==e.itemId){if("field empty"===await e.editTask(e.itemId,n,!1))o(e.task),e.handleClose();else{const t=await e.getList();e.setData(t)}}else l()("Error","Error Editing Task","error"),e.handleClose()}(),e.handleClose()):"cancelEdit"===t.target.className&&(o(e.task),e.handleClose())}return Object(s.useEffect)((()=>{o(e.task),!1===e.itemStatus?a("Status: Incomplete"):!0===e.itemStatus&&a("Status: Complete")}),[e.itemStatus,e.task]),Object(k.jsx)(g.a,{show:e.modalShow,onHide:e.handleClose,backdrop:"static",keyboard:!1,children:Object(k.jsxs)("div",{className:"modalContainer",children:[Object(k.jsxs)("div",{className:"editorTextItems",children:[Object(k.jsxs)("p",{className:"createdAtText",children:["Created: ",r]}),Object(k.jsxs)("p",{className:"updatedAtText",children:["Updated: ",c]}),Object(k.jsx)("p",{className:"updateStatus",children:t}),Object(k.jsx)("input",{className:"editTask",value:n,onChange:function(e){o(e.target.value)},onKeyDown:e.enter,type:"text"})]}),Object(k.jsx)("hr",{}),Object(k.jsxs)("div",{className:"editorButtons",children:[Object(k.jsx)("button",{className:"cancelEdit",onClick:i,children:"Cancel"}),Object(k.jsx)("button",{className:"confirmEdit",onClick:i,children:"Confirm"})]})]})})};var x=function(e){const[t,a]=Object(s.useState)(!1);return Object(k.jsxs)("li",{children:[Object(k.jsx)(b,{getList:e.getList,setData:e.setData,itemId:e.itemId,createdAt:e.createdAt,updatedAt:e.updatedAt,itemStatus:e.status,task:e.task,modalShow:t,handleClose:()=>a(!1),editTask:j,enter:e.enter}),Object(k.jsxs)("div",{className:"taskList",children:[Object(k.jsx)("input",{type:"checkbox",className:"taskStatus",checked:e.status,onChange:t=>{e.editTaskStatus(e.itemId,t)}}),Object(k.jsx)("button",{className:"deleteBtn",onClick:()=>{e.deleteBtnClick(e.itemId)},children:Object(k.jsx)("i",{className:"fas fa-trash-alt fa-2x"})}),Object(k.jsx)("button",{className:"editBtn",onClick:()=>a(!0),children:Object(k.jsx)("i",{className:"fas fa-edit fa-2x"})}),Object(k.jsx)("p",{className:"taskItem",style:!0===e.status?{textDecoration:"line-through",color:"gray"}:{textDecoration:"none"},children:e.task}),Object(k.jsx)("hr",{})]})]})};var O=function(){let[e,t]=Object(s.useState)([]);const[a,n]=Object(s.useState)(""),o=localStorage.getItem("email");async function r(){if(a&&""!==a&&" "!==a){await(e=a,u.accessToken||u.refreshToken?e&&""!==e?fetch("".concat(d(),"/todo"),{method:"POST",headers:m,body:JSON.stringify({task:e,status:!1})}):void l()("Error","Do Not Leave Text Field Empty","error"):(l()("Error","Session Expired, Please Log In","error").then((function(){window.location.href="/"})),[{error:"session expired"}]));const s=await h();t(s),n("")}else l()("Error","Please enter a task","error");var e}async function c(e){if(e&&""!==e){await async function(e){return fetch("".concat(d(),"/todo/").concat(e),{method:"DELETE",headers:m})}(e);const a=await h();t(a)}else l()("Error","Please select a task to delete","error")}function i(e){if(13===e.keyCode&&"addTask"===e.target.className){document.getElementsByClassName("addTaskBtn")[0].click()}else if(13===e.keyCode&&"editTask"===e.target.className){document.getElementsByClassName("confirmEdit")[0].click()}}async function p(a,s){let n=null;for(let t=0;t<e.length;t++){const s=e[t];if(s._id===a){n=s;break}}if(n){await j(a,n.task,s.target.checked);const e=await h();t(e)}else l()("Error","Error Editing Task Status","error")}return Object(s.useEffect)((()=>{(async()=>{t(await h())})(),setInterval((()=>{!async function(e){fetch("".concat(d(),"/newAccessToken"),{method:"POST",body:JSON.stringify({email:e}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(u.refreshToken)}}).then((e=>e.json())).then((e=>{"undefined"===e.accessToken||"invalid token"===e.message?(localStorage.setItem("refreshToken","undefined"),localStorage.setItem("accessToken","undefined"),localStorage.setItem("email","undefined"),l()("Error","Session Expired, Please Log In","error").then((function(){window.location.href="/"}))):localStorage.setItem("accessToken",e.accessToken)}))}(o)}),5e3)}),[o]),Object(k.jsxs)("div",{className:"container",children:[Object(k.jsx)("button",{className:"logOutButton",onClick:f,children:"Log Out"}),Object(k.jsxs)("div",{className:"toDoListContainer",children:[Object(k.jsx)("h1",{className:"headerTitle",children:"To-Do List"}),Object(k.jsxs)("ul",{children:[Object(k.jsx)("hr",{}),e.map((e=>Object(k.jsx)(x,{getList:h,setData:t,itemId:e._id,task:e.task,status:e.status,createdAt:e.createdAt,updatedAt:e.updatedAt,editTask:j,deleteBtnClick:c,editTaskStatus:p,enter:i},e._id)))]}),Object(k.jsxs)("div",{className:"listFooter",children:[Object(k.jsx)("input",{type:"text",value:a,onKeyDown:i,onChange:function(e){n(e.target.value)},className:"addTask",placeholder:"Enter Task"}),Object(k.jsx)("button",{onClick:r,className:"addTaskBtn",children:"Add Task"}),Object(k.jsx)("button",{onClick:r,className:"shortAddTaskBtn",children:"+"})]})]})]})};var T=function(e){const t=Object(c.e)(),[a,n]=Object(s.useState)({email:"",password:""});function o(e){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e).toLowerCase())}function r(e){const{value:t,className:a}=e.target;n((e=>"emailInput"===a?{email:t,password:e.password}:{email:e.email,password:t}))}function i(e){if(13===e.keyCode){document.getElementsByClassName("submitUser")[0].click()}}return Object(k.jsxs)("div",{className:"userRegistrationContainer",children:[Object(k.jsx)("h1",{className:"regGreeting",children:e.greeting}),Object(k.jsx)("input",{className:"emailInput",onChange:r,onKeyDown:i,type:"text",placeholder:"Email"}),Object(k.jsx)("input",{className:"passwordInput",onChange:r,onKeyDown:i,type:"password",placeholder:"Password"}),Object(k.jsx)("button",{className:"submitUser",onClick:function(){var e,s;"/login"===t.location.pathname||"/"===t.location.pathname?a.email&&""!==a.email&&a.password&&""!==a.password&&o(a.email)?p(a.email,a.password):l()("Error","Please enter a valid email and password","error"):"/signup"===t.location.pathname&&(a.email&&""!==a.email&&a.password&&""!==a.password&&o(a.email)?(e=a.email,s=a.password,fetch("".concat(d(),"/users/signup"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e,password:s})}).then((e=>e.json())).then((t=>{"a user with this email already exists"===t.message?l()("Error","A user with this email already Exists","error"):l()({title:"Success",text:"Successfully Signed Up! Logging In...",icon:"success",timer:1500,buttons:[""]}).then((()=>{p(e,s)}))}))):l()("Error","Please enter a valid email and password","error"))},children:e.userCredentials}),Object(k.jsxs)("p",{className:"regFooter",children:[e.accountStatus," ",Object(k.jsx)("a",{className:"regRedirectLink",href:e.redirectLink,children:e.redirect})]})]})};var w=function(){const e=Object(c.e)();return Object(k.jsx)("div",{className:"userRegistrationContainer",children:"/login"===e.location.pathname||"/"===e.location.pathname?Object(k.jsx)(T,{greeting:"Welcome Back",userCredentials:"Login",accountStatus:"Don't Have An Account? ",redirect:"Sign Up",redirectLink:"signup"}):Object(k.jsx)(T,{greeting:"Welcome",userCredentials:"Sign Up",accountStatus:"Already Have An Account?",redirect:"Log In",redirectLink:"/login"})})};var S=function(){return Object(k.jsxs)(r.a,{children:[Object(k.jsx)(c.a,{path:["/","/login"],component:w,exact:!0}),Object(k.jsx)(c.a,{path:"/signup",component:w}),Object(k.jsx)(c.a,{path:"/list",component:O})]})};o.a.render(Object(k.jsx)(S,{}),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.72d23dc7.chunk.js.map